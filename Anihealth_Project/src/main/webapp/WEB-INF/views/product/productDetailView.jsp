<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    <%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>   
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>

<style>
  /* Î©îÏù∏Ïª®ÌÖåÏ∏†ÏòÅÏó≠ ÏãúÏûë */
        .parent {
            width: 100%;
            padding-top: 100px;
            padding-bottom: 50px;
        }

        .parent-container {
            width: 100%;
        }

        .header-faq {
            text-align: center;
            padding-bottom: 20px;
            /* margin-bottom: 60px; */
        }
        .header-faq h1{
            color: #57585c;
            text-align: center;
        }

        /* Ï†úÌíàÏù¥ÎØ∏ÏßÄÎûë Íµ¨Îß§Í∞Ä ÏòÅÏó≠ ÏãúÏûë */
        .parent-info {
            background-color: #f6f9f9c9;
            width: 60%; 
            margin: 0 auto;
            padding-top: 5px;
            padding-bottom: 20px; 
            padding-right: 40px;
            border-radius: 30px;
        }

        .info-table {
            width: 100%; 
            margin: 0 auto;   
            padding-top: 10px; 
            margin-top: 30px; 
            border-collapse: collapse;
        }

        .td-left {
            padding: 10px;
            text-align: left;
            white-space: nowrap; 
        }
  
        .img-thumb {
            display: block;
            margin: 0 auto;
            width: 80%;
            height: auto;
            border-radius: 45px;
        }

        .quantity-content span {
            vertical-align: middle;
        }
        .quantity-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
        }
        .quantity-content {
            display: flex;
            align-items: center;
        }
        .quantity-content span{
            margin-right: 10px;
        }

        .quantity-content button {
            margin: 0 5px;
            padding: 5px 10px;
            cursor: pointer;
        }
        
        .price-row td strong,
		.quantity-row td.quantity {
		    font-size: 1.2em; /* Í∏ÄÏûê ÌÅ¨Í∏∞Î•º ÌÇ§ÏõÅÎãàÎã§ */
		}
		
		.price-row td,
		.quantity-row td {
		    font-size: 1.1em; /* Í∏ÄÏûê ÌÅ¨Í∏∞Î•º ÌÇ§ÏõÅÎãàÎã§ */
		}
		
		.quantity-content span {
		    font-size: 1.1em; /* ÏàòÎüâ Í∏ÄÏûê ÌÅ¨Í∏∞Î•º ÌÇ§ÏõÅÎãàÎã§ */
		}

        .button-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        #heart1 {
            font-size: large;
         	margin-left: 30px;
         	border: 2px solid  rgb(233, 199, 199);
        }

        #cart1 {
            color: white;
            background-color: rgb(139, 198, 178);
            font-weight: bold;
         	padding: 10px 20px;
        }
         #cart1:hover{
            padding: 10px 20px;
         	 color: white;
         	 font-weight: bold;
         	 background-color: rgb(106, 165, 145);
         }
        

        #table-line{
            border-bottom: 2px solid rgb(55, 51, 51);
            width: 90%;
            margin: 0 auto;    
        }
         /* Ï†úÌíàÏù¥ÎØ∏ÏßÄÎûë Íµ¨Îß§Í∞Ä ÏòÅÏó≠ ÎÅù*/


         .gray-line {
            width: 70%; 
            margin: 0 auto;
            border-bottom: 2px solid lightgray;
            margin-top: 30px;
            margin-bottom: 30px;
        }


    	/* ÏòÅÏñëÏ†ú ÏÉÅÏÑ∏ÏÑ§Î™Ö ÏãúÏûë */
		.detail-list-container {
		    width: 85%;
		    margin: 0 auto;
		    margin-top: 40px;
		    text-align: center;
		    padding-top: 20px;
		}
		.section-heading {
		    color: #333; 
		    margin-bottom: 10px; 
		    font-size: 24px; 
		}
			
		.effect-container {
		    display: flex;
		    justify-content: space-between; /* Ìö®Îä•Í≥º Î∂ÄÏûëÏö©ÏùÑ Ïñë ÏòÜÏúºÎ°ú Î∞∞Ïπò */
		    margin-top: 20px;
		    margin-bottom: 20px;
		    
		}
		
		.effect-cell {
		    width: 50%;
		    border: 1px solid #ddd;
		    padding: 10px;
		    border-radius: 8px;
		    text-align: center; /* Ìö®Îä•Í≥º Î∂ÄÏûëÏö© ÎÇ¥Ïö© Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ */
		}
		
		.effect-cell:first-child {
		    margin-right: 2%; /* Ìö®Îä•Í≥º Î∂ÄÏûëÏö© ÏÇ¨Ïù¥ Í∞ÑÍ≤©ÏùÑ Ï°∞Ï†àÌï©ÎãàÎã§ */
		}
		
		.effect-items {
		    display: flex;
		    flex-wrap: wrap; /* Í≥µÍ∞ÑÏù¥ Î∂ÄÏ°±Ìï† Í≤ΩÏö∞ Ìï≠Î™©ÏùÑ Îã§Ïùå Ï§ÑÎ°ú ÎÑòÍπÅÎãàÎã§ */
		    justify-content: center; /* Í∞ÄÏö¥Îç∞ Ï†ïÎ†¨ */
		}
		
		.effect-item {
		    margin-right: 20px; /* Í∞Å Ìï≠Î™© ÏÇ¨Ïù¥ Í∞ÑÍ≤©ÏùÑ Ï°∞Ï†àÌï©ÎãàÎã§ */
		    margin-bottom: 10px; /* Ìï≠Î™©Îì§ ÏÇ¨Ïù¥Ïùò Ïó¨Î∞±ÏùÑ Ï°∞Ï†àÌï©ÎãàÎã§ */
		    text-align: center;
		}
		
		.section-title {
			    margin-bottom: 20px; /
			      color: #333; 
			}
			
		.effect-image {
		    width: 100px;
		    height: 100px;
		    object-fit: cover; /* Ïù¥ÎØ∏ÏßÄÎ•º ÌôïÎåÄ ÎòêÎäî Ï∂ïÏÜåÌïòÏó¨ Ï±ÑÏõÅÎãàÎã§ */
		    border-radius: 50%; /* Ïù¥ÎØ∏ÏßÄÎ•º Îë•Í∏ÄÍ≤å ÎßåÎì≠ÎãàÎã§ */
		}
		
		.effect-name {
		    font-weight: bold;
		    margin-top: 5px;
		     color: #666; 
		}
		
		.img-detail {
		    margin-top: 30px;
		    width: 100%;
		    max-width: 100%;
		    height: 300px;
		}
		 .no-side-effect-text {
	        font-weight: bold;
	        color: #666; 
	        margin-top: 5px; /* ÏÉÅÎã® Ïó¨Î∞± ÏÑ§Ï†ï */
	        font-size: 18px;
	    }
		
		/* ÏòÅÏñëÏ†ú ÏÉÅÏÑ∏ÏÑ§Î™Ö ÎÅù */

        /* ÌÉ≠Î≤ÑÌäºÏòÅÏó≠ÏãúÏûë */
        ul.list {
            list-style-type: none;
            margin: 0;
            padding: 0;
            border-bottom: 2px solid #ccc;
        }
        ul.list::after {
            content: '';
            display: block;
            clear: both;
        }
        .tab-button {
            display: block;
            padding: 10px 40px; 
            float: left;
            margin-right: -1px;
            margin-bottom: -1px;
            color: grey;
            text-decoration: none;
            cursor: pointer;
            font-size: 1.3em; 
        }
        .green {
            border-top: 3px solid rgb(175, 215, 175);
            border-right: 2px solid #ccc;
            border-bottom: 1px solid white;
            border-left: 2px solid #ccc;
            color: black;
            margin-top: -2px;
        }
        .tab-content {
            display: none;
            padding: 10px;
        }
        .show {
            display: block;
        }
        .cont {
            width: 70%; 
            margin: 0 auto; /* ÏàòÌèâ Ï§ëÏïô Ï†ïÎ†¨ */
            padding-top: 20px; /* ÏÉÅÎã® Ìå®Îî© */
            padding-bottom: 20px; /* ÌïòÎã® Ìå®Îî© */
            border-radius: 10px; /* ÌÖåÎëêÎ¶¨ Îë•Í∏ÄÍ≤å ÏÑ§Ï†ï */
        }
        /* ÌÉ≠Î≤ÑÌäº ÏòÅÏó≠ ÎÅù */

        /* Î™©Î°ùÏúºÎ°ú Î≤ÑÌäº ÏòÅÏó≠ÏãúÏûë */
        .btn-list-container {
            width: 100%;
            text-align: center; /* Ï§ëÏïô Ï†ïÎ†¨ */
        }


        .btn-list>button {
            font-size: 120%;
            font-weight: bold;
            cursor: pointer; 
            border: 3px solid rgb(82, 166, 121);
            color: rgb(83, 88, 88);
            font-weight: 600;
            margin-top: 40px;
        }
        /*Î™©Î°ùÏúºÎ°ú Î≤ÑÌäº ÏòÅÏó≠ÎÅù */
</style>


</head>
<body>


<jsp:include page="../common/header.jsp" />


<div class="parent">


        <div class="parent-container">
            <div class="header-faq">
                <h1>ÏòÅÏñëÏ†ú ÏÉÅÏÑ∏Î≥¥Í∏∞</h1>
            </div>
        </div>
        <div class="gray-line"></div> 


   
       <div class="parent-info">
          <table class="info-table">
             <tbody>
	                <form id="addToCartForm">
		                    <!-- Hidden field for product number -->
		                      <input type="hidden" name="productNo" value="${product.productNo}">
		       				 	<input type="hidden" name="price" value="${product.price}">
		                    <tr>
			                    <td rowspan="8" style="width: 60%;">
			                        <img src="${pageContext.request.contextPath}/${product.productThumbnailPath}" 
			                             alt="${product.productName}"
			                             class="img-thumb">
			                    </td>
		                    </tr>
		                    <tr>
			                    <td class="td-left">
			                        <h5 style="font-weight: bold; color: rgb(118, 117, 117);">${product.category} ÏòÅÏñëÏ†ú</h5>
			                        <h4 style="font-weight: bold;">${product.productName}</h4>
			                    </td>
		                    </tr>
		                    <tr class="price-row" style="border-bottom: 2px solid rgb(198, 196, 196); background-color: rgb(254, 245, 237);">
			                    <td class="td-left"><strong>Íµ¨Îß§Í∞Ä</strong></td>
			                    <td><strong id="priceDisplay">‚Ç© ${product.price}</strong></td>
		                    </tr>
		                    <tr class="quantity-row" style="background-color: rgb(254, 245, 237);">
			                    <td class="quantity td-left">ÏàòÎüâ</td>
			                    <td colspan="3">
			                        <div class="quantity-content">
			                         <span> Ï¥ù  1   Í∞ú </span>
			                        </div>
			                    </td>
		                    </tr>
		                    <tr>
			                    <td colspan="2">
			                        <div class="button-container">
			                         <button type="button" id="heart1" class="btn btn-lg heart">${wishlistAdded ? '‚ù§Ô∏è' : 'ü§ç'}</button>
			                        <button type="button" id="cart1" class="btn btn-lg cart-btn">Ïû•Î∞îÍµ¨Îãà Îã¥Í∏∞</button> 
			                        </div>
			                    </td>
		                    </tr>
	                 </form>
                </tbody>
            </table>
        </div>
         <br><br>
         
         

        <script>
		    document.getElementById("cart1").addEventListener("click", function() {
		        $.ajax({
		            url: "checkLogin",
		            type: "get",
		            success: function(response) {
		                if (response.loggedIn) {
		                    // Proceed with adding to cart
		                    const form = document.getElementById("addToCartForm");
		                    const formData = {
		                        productNo: form.productNo.value,
		                        price: form.price.value,
		                    };
		                    $.ajax({
		                        url: "cart.ad",
		                        type: "post",
		                        contentType: "application/json",
		                        data: JSON.stringify(formData),
		                        success: function(result) {
		                            if (result.success) {
		                                console.log(result.message);
		                                alert(result.message);
		                            } else {
		                                console.log(result.message);
		                                alert(result.message);
		                            }
		                        },
		                        error: function() {
		                            console.log("Ïû•Î∞îÍµ¨Îãà Îã¥Í∏∞ Ïã§Ìå®");
		                            alert("Ïû•Î∞îÍµ¨Îãà Îã¥Í∏∞ Ïã§Ìå®");
		
		                        }
		                    });
		                } else {
		                    alert("Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.");
		                }
		            },
		            error: function() {
		                console.log("Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌôïÏù∏ Ïã§Ìå®");
		                alert("Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌôïÏù∏ Ïã§Ìå®");
		            }
		        });
		    });
		    	    
    </script>
    
    
   <script>
			$(document).ready(function() {
			    const heartBtn = $("#heart1");
			    const productNo = ${product.productNo}; // ÏÑúÎ≤Ñ Ï∏°ÏóêÏÑú Ìï†ÎãπÎêú Ïã§Ï†ú ÏÉÅÌíà Î≤àÌò∏Î°ú Î≥ÄÍ≤Ω
			
			    // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÏúÑÏãúÎ¶¨Ïä§Ìä∏ ÏÉÅÌÉú ÌôïÏù∏
			    checkWishlistStatus();
			
			    // ÌïòÌä∏ Î≤ÑÌäº ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏
			    heartBtn.click(function() {
			        $.ajax({
			            url: "checkLogin1",
			            type: "GET",
			            success: function(response) {
			                if (response.loggedIn) {
			                    const formData = {
			                        productNo: productNo,
			                        userNo: response.userNo
			                    };
			
			                    // Ajax ÏöîÏ≤≠: toggleHeart.pdÎ°ú POST ÏöîÏ≤≠
			                    $.ajax({
			                        url: "toggleHeart.pd",
			                        type: "POST",
			                        contentType: "application/json",
			                        data: JSON.stringify(formData),
			                        success: function(result) {
			                            if (result.success) {
			                                console.log(result.message);
			                                alert(result.message);
			
			                                // ÌïòÌä∏ Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
			                                if (result.added) {
			                                    heartBtn.text("‚ù§Ô∏è"); // ÌïòÌä∏ Ï∂îÍ∞Ä ÏÉÅÌÉú
			                                } else {
			                                    heartBtn.text("ü§ç"); // ÌïòÌä∏ Ï†úÍ±∞ ÏÉÅÌÉú
			                                }
			                            } else {
			                                console.log(result.message);
			                                alert(result.message);
			                            }
			                        },
			                        error: function() {
			                            console.log("ÏÑúÎ≤Ñ Ïò§Î•ò: ÌïòÌä∏ Ï∂îÍ∞Ä/ÏÇ≠Ï†ú Ïã§Ìå®");
			                            alert("ÏÑúÎ≤Ñ Ïò§Î•ò: ÌïòÌä∏ Ï∂îÍ∞Ä/ÏÇ≠Ï†ú Ïã§Ìå®");
			                        }
			                    });
			                } else {
			                    alert("Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§.");
			                }
			            },
			            error: function() {
			                console.log("Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌôïÏù∏ Ïã§Ìå®");
			                alert("Î°úÍ∑∏Ïù∏ ÏÉÅÌÉú ÌôïÏù∏ Ïã§Ìå®");
			            }
			        });
			    });
			
			    function checkWishlistStatus() {
			        $.ajax({
			            url: "checkWishlistStatus",
			            type: "GET",
			            data: { productNo: productNo },
			            success: function(response) {
			                if (response.inWishlist) {
			                    heartBtn.text("‚ù§Ô∏è"); // ÌïòÌä∏ Ï∂îÍ∞Ä ÏÉÅÌÉú
			                } else {
			                    heartBtn.text("ü§ç"); // ÌïòÌä∏ Ï†úÍ±∞ ÏÉÅÌÉú
			                }
			            },
			            error: function() {
			                console.log("ÏúÑÏãúÎ¶¨Ïä§Ìä∏ ÏÉÅÌÉú ÌôïÏù∏ Ïã§Ìå®");
			                alert("ÏúÑÏãúÎ¶¨Ïä§Ìä∏ ÏÉÅÌÉú ÌôïÏù∏ Ïã§Ìå®");
			            }
			        });
			    }
			});
  </script>
          
                  <div class="cont">
	                
	                <ul class="list">
	                    <li class="tab-button green" data-id="0">ÏÉÅÏÑ∏Ï†ïÎ≥¥</li>
	                    <li class="tab-button" data-id="1">ÏÉÅÌíàÌõÑÍ∏∞</li>
	                </ul>
	                
	                <div class="tab-content show">	                        
								<div class="detail-list-container">
								    <h4 class="section-heading">ÏÉÅÏÑ∏ Ï†ïÎ≥¥</h4>
								    <div class="effect-container">
								        <!-- Ìö®Îä• Ïπ∏ -->
								        <div class="effect-cell">
								            <h5 style="font-weight: bold;"  class="section-title">Ìö®Îä•</h5>
								            <div class="effect-items">
								                <!-- Ìö®Îä• Ìï≠Î™© Î∞òÎ≥µÎ¨∏ -->
								                <c:forEach var="c" items="${requestScope.effects}">
								                    <div class="effect-item">
								                        <img src="${pageContext.request.contextPath}/${c.effectFilePath}" alt="Ìö®Í≥º ÏÇ¨ÏßÑ" class="effect-image">
								                        <div class="effect-name">${c.effectName}</div>
								                    </div>
								                </c:forEach>
								            </div>
								        </div>
								        
								        <!-- Î∂ÄÏûëÏö© Ïπ∏ -->
								        <div class="effect-cell">
								            <h5 style="font-weight: bold;"  class="section-title">Î∂ÄÏûëÏö©</h5>
								            <div class="effect-items">
								                <!-- Î∂ÄÏûëÏö© Ìï≠Î™© Î∞òÎ≥µÎ¨∏ -->
								                <c:forEach var="se" items="${requestScope.sideEffects}">
								                    <div class="effect-item">
								                        <img src="${pageContext.request.contextPath}/${se.effectFilePath}" alt="Ìö®Í≥º ÏÇ¨ÏßÑ" class="effect-image">
								                        <div class="effect-name">${se.effectName}</div>
								                    </div>
								                </c:forEach>
								            </div>
								        </div>
								    </div>
								    <img src="${pageContext.request.contextPath}/${product.productDetailPath}" alt="ÏÉÅÏÑ∏ Ï†ïÎ≥¥ Ïù¥ÎØ∏ÏßÄ" style="border: 1px solid;" class="img-detail">
								</div>				    
						</div>  		
							   <div class="tab-content">
							   <jsp:include page="../review/productReview.jsp">
                			<jsp:param name="productNo" value="${product.productNo}" />
						</jsp:include>
	                            </div>  
						              
                    </div>
	
			   <br>  <br>
            <div class="btn-list-container" >
                <div class="btn-list">
                    <button class="btn btn-lg"
                                onclick="location.href='list.pd'">
                                					Î™©Î°ùÏúºÎ°ú
                    </button>
                </div>
            </div>
             <br>  <br>  
         
</div>



<jsp:include page="../common/footer.jsp" />

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var sideEffects = document.querySelectorAll(".effect-cell:nth-child(2) .effect-item");
        if (sideEffects.length === 0) {
            var noSideEffectText = document.createElement("div");
            noSideEffectText.classList.add("effect-item", "no-side-effect-text");
            noSideEffectText.textContent = "Î∂ÄÏûëÏö©Ïù¥ ÏóÜÏäµÎãàÎã§.";
            
            var sideEffectContainer = document.querySelector(".effect-cell:nth-child(2) .effect-items");
            sideEffectContainer.appendChild(noSideEffectText);
        }
    });
</script>




<script>

    //ÌÉ≠ Ï†ÑÌôò Î≤ÑÌäº ÏòÅÏó≠
    $('.tab-button').click(function (e) {
        if ($(e.target).hasClass('tab-button')) {
            openTab($(e.target).data('id')); // ÌÅ¥Î¶≠Îêú Î≤ÑÌäºÏùò data-idÎ•º Í∞ÄÏ†∏ÏôÄÏÑú ÌÉ≠ Ï†ÑÌôò
        }
    });

    function openTab(number) { // Ìï®Ïàò Ïù¥Î¶ÑÏùÑ 'openTab'ÏúºÎ°ú, ÌååÎùºÎØ∏ÌÑ∞Î•º 'number'Î°ú Î≥ÄÍ≤Ω
        $('.tab-button').removeClass('green');
        $('.tab-button').eq(number).addClass('green');
        $('.tab-content').removeClass('show');
        $('.tab-content').eq(number).addClass('show');
    }
</script>


</body>
</html>